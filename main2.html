<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>MAIN</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" as="style" crossorigin href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.css" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
<script src="data.js"></script>

<style>
  /* [ê¸°ë³¸ ì„¤ì •] */
  *{margin:0;padding:0;box-sizing:border-box;font-family:'Pretendard',sans-serif}
  body{background:#F8F9FB; color:#333; padding-bottom: 120px;}
  
  /* [í—¤ë”] */
  .header{height:64px; display:flex; justify-content:space-between; align-items:center; padding:0 24px; background:#fff; border-bottom:1px solid #E0E4EA; position:sticky; top:0; z-index:100;}
  .header h1{font-size:20px; font-weight:700; color:#bd2aa4; cursor:pointer;}
  
  /* [ì‚¬ì´ë“œ ë©”ë‰´] */
  .menu{position:fixed; top:0; right:0; width:280px; height:100%; background:#fff; padding:30px; transform:translateX(100%); transition:.3s; z-index:1000; box-shadow:-10px 0 20px rgba(0,0,0,0.05)}
  .menu.open{transform:translateX(0)}
  .menu a{display:block; margin:25px 0; font-size:16px; font-weight:600; color:#444; text-decoration:none; cursor:pointer;}
  .menu-trigger { font-size: 28px; font-weight: bold; color: #333; cursor: pointer; }

  /* [íˆì–´ë¡œ ë°°ë„ˆ] */
  .hero { 
    height: 300px; 
    background: linear-gradient(rgba(0,0,0,0.4), rgba(0,0,0,0.4)), url('./asset/hero_banner.jpg'); 
    background-size: cover; background-position: center; 
    display: flex; align-items: center; justify-content: center; color: #fff; text-align: center; 
  }
  .hero h2 { font-size: 36px; letter-spacing: -1px; }

  /* [ë©”ì¸ ì»¨í…ì¸  ë ˆì´ì•„ì›ƒ] */
  #content-area { max-width: 1100px; margin: 0 auto; padding: 40px 20px; min-height: 50vh; }
  
  /* [í˜¸í…” ê·¸ë¦¬ë“œ & í•„í„°] */
  .filters { display: flex; justify-content: flex-end; gap: 10px; margin-bottom: 25px; }
  .filter-btn { padding: 8px 16px; border: 1px solid #ddd; background: #fff; border-radius: 20px; cursor: pointer; font-size: 13px; transition: 0.2s; }
  .filter-btn:hover, .filter-btn.active { background: #bd2aa4; color: #fff; border-color: #bd2aa4; }
  
  .hotel-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 30px; }
  .hotel-card { background:#fff; border-radius:16px; overflow:hidden; box-shadow:0 10px 20px rgba(0,0,0,0.05); transition:.3s; border: 1px solid #eee; }
  .hotel-card:hover { transform:translateY(-8px); }
  .hotel-img { height:200px; background-size:cover; background-position:center; }
  .hotel-info { padding:24px; text-align: left; }
  .price-tag { font-size:20px; font-weight:800; color:#bd2aa4; }
  .btn-reserve { width:100%; padding:14px; background:#111; color:#fff; border:none; border-radius:8px; cursor:pointer; font-weight:700; margin-top:20px; }

  /* [ìƒì„¸ í˜ì´ì§€ ì „ìš© ì¹´ë“œ] */
  .section-card { background: #fff; padding: 30px; border-radius: 20px; border: 1px solid #eee; margin-bottom: 30px; box-shadow: 0 4px 12px rgba(0,0,0,0.03); text-align: left; }
  .booking-layout { display: flex; gap: 24px; align-items: flex-start; margin-bottom: 30px; }
  .cal-box { flex: 0 0 350px; gap: 15px;}
  .room-box { flex: 1; }
  .room-card { display: flex; gap: 15px; padding: 15px; border: 2px solid #f0f0f0; border-radius: 16px; cursor: pointer; margin-bottom: 12px; transition: 0.3s; background: #fff; align-items: center; }
  .room-card.active { border-color: #bd2aa4; background: #fdf5fc; }
  .room-img-sm { width: 120px; height: 90px; border-radius: 12px; object-fit: cover; }
  
  /* [ê°ì‹¤ ì˜µì…˜ íŒ¨ë„] */
  .option-panel { max-height: 0; overflow: hidden; opacity: 0; transition: 0.4s ease; background: #fff; border: 1px solid #eee; border-radius: 15px; margin-top: -8px; margin-bottom: 20px; }
  .option-panel.show { max-height: 1200px; opacity: 1; padding: 25px; }
  .counter-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; }
  .cnt-btns { display: flex; align-items: center; gap: 12px; }
  .cnt-btns button { width: 30px; height: 30px; border-radius: 50%; border: 1px solid #ddd; background: #fff; cursor: pointer; }

  /* [í•˜ë‹¨ ê²°ì œë°”] */
  .payment-fix { position: fixed; bottom: 0; left: 0; width: 100%; background: #fff; padding: 20px 40px; border-top: 1px solid #eee; display: flex; justify-content: space-between; align-items: center; z-index: 1000; box-shadow: 0 -5px 15px rgba(0,0,0,0.05); }
  
  /* [ì„œë¸Œ ì¹´ë“œ: ë¡œê·¸ì¸/CS/FAQ] */
  .sub-card { max-width: 500px; margin: 0 auto; padding: 40px; background: #fff; border-radius: 20px; box-shadow: 0 10px 40px rgba(0,0,0,0.06); text-align: center; }
  .input-field { width: 100%; padding: 15px; margin: 10px 0; border: 1px solid #ddd; border-radius: 10px; outline: none; }
  .faq-search { width: 100%; padding: 14px 16px; border: 1px solid #ddd; border-radius: 12px; outline: none; margin-bottom: 20px; }
  .map-frame { width: 100%; height: 350px; border-radius: 15px; border: 1px solid #eee; }

  /* [ì„¸ë¶€ ì„¤ì •ë‚´ ì¤‘ì²©ëœ ì•„ì½”ë””ì–¸] */
  .inner-acc { border: 1px solid #edf1f7; border-radius: 12px; margin-bottom: 20px; overflow: hidden; background: #fff; box-shadow: 0 2px 8px rgba(0,0,0,0.02); }
  .inner-acc-head { padding: 16px 20px; background: #fcfcfd; cursor: pointer; display: flex; justify-content: space-between; align-items: center; transition: 0.2s; }
  .inner-acc-head:hover { background: #f4f7fa; }
  .inner-acc-head span:first-child { font-size: 15px; font-weight: 700; color: #444; display: flex; align-items: center; gap: 8px; }
  .inner-acc-head span:last-child { font-size: 10px; color: #bd2aa4; background: #fdf5fc; width: 24px; height: 24px; display: flex; align-items: center; justify-content: center; border-radius: 50%; transition: 0.3s; }
  .inner-acc-body { max-height: 0; opacity: 0; overflow: hidden; transition: all 0.3s ease; background: #fff; line-height: 1.8; color: #666; font-size: 14px; padding: 0 20px; }
  .inner-acc-body.open { max-height: 500px; opacity: 1; padding: 20px; border-top: 1px solid #f1f1f1; }

  /* ê´€ë¦¬ì í˜ì´ì§€ ì „ìš© ìŠ¤íƒ€ì¼ */
  .admin-container { background: #fff; padding: 30px; border-radius: 12px; box-shadow: 0 10px 30px rgba(0,0,0,0.05); }
  .admin-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; border-bottom: 2px solid #bd2aa4; padding-bottom: 20px; }
  .stats-row { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-bottom: 30px; }
  .stat-card { background: #f8f9fb; padding: 20px; border-radius: 8px; border: 1px solid #eee; text-align: center; }
  .stat-card h2 { color: #bd2aa4; font-size: 24px; }

  .admin-table { width: 100%; border-collapse: collapse; margin-top: 10px; font-size: 14px; }
  .admin-table th { background: #f8f9fb; padding: 15px; text-align: left; border-bottom: 2px solid #eee; color: #666; }
  .admin-table td { padding: 15px; border-bottom: 1px solid #eee; }
  .btn-excel { background: #27ae60; color: #fff; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; font-weight: 600; }
  .btn-delete { color: #ff4d4d; border: 1px solid #ff4d4d; background: none; padding: 5px 10px; border-radius: 4px; cursor: pointer; }

  /* í‘¸í„° ìŠ¤íƒ€ì¼ */
  .footer {width: 100vw; position: relative; left: 50%; right: 50%; margin-left: -50vw; margin-right: -50vw; background: #fff; padding: 60px 0; border-top: 1px solid #E0E4EA; margin-top: 80px;}
  .footer-inner {max-width: 1200px; margin: 0 auto; padding : 0 24px;}
  .footer-info {font-size: 13px; color: #666; line-height: 2;}
  .footer-logo img {height: 35px; width: auto; filter : grayscale(20%); margin-bottom: 25px;}

</style>
</head>

<body>
<div class="header">
    <div onclick="location.reload()" style="cursor:pointer; display:flex; align-items:center; padding: 10px 0;">
        <img src="./asset/logo.jpg" alt="Logo" style="height:40px; width:auto; object-fit:contain;">
    </div>
    <div style="display: flex; align-items: center; gap: 15px;">
        <div id="auth-area"></div>
        <div class="menu-trigger" onclick="toggleMenu()">â˜°</div>
    </div>
</div>

<nav class="menu" id="sideMenu">
  <div onclick="toggleMenu()" style="text-align:right; cursor:pointer; font-size:24px; margin-bottom:20px;">âœ•</div>
  <a onclick="showSection('booking')">ğŸ¨ ìˆ™ë°•ì˜ˆì•½</a>
  <a onclick="showSection('login')">ğŸ” ì˜ˆì•½ì¡°íšŒ</a>
  <a onclick="showSection('cs')">ğŸ“ ê³ ê°ì„¼í„°</a>
  <a onclick="showSection('faq')">â“ ìì£¼ ë¬»ëŠ” ì§ˆë¬¸</a>
</nav>

<div class="hero">
  <div><h2 id="heroTitle">Title</h2><p id="heroSub">Hero Sub</p></div>
</div>

<div id="content-area"></div>

<div id="payment-bar" class="payment-fix" style="display:none;">
    <div><span style="color:#888; font-size:14px;">ìµœì¢… ê²°ì œ ê¸ˆì•¡</span><br><span id="totalAmount" style="font-size: 28px; font-weight: 800; color: #bd2aa4;">0</span>ì›</div>
    <button class="btn-reserve" style="width:220px; margin:0; background:#bd2aa4;" onclick="renderPaymentView()">ì˜ˆì•½ ì‹ ì²­í•˜ê¸°</button>
</div>

<script>

    
// [ìƒíƒœ ê´€ë¦¬ ë° ì´ˆê¸°í™”]
let state = { nights: 0, roomPrice: 0, guests: 1, bf: 0, roomCount: 1, currentHotelId: null, roomType: "" }; 

function getFooter() {
    return `
    <footer class="footer">
        <div class="footer-inner">
            <div class="footer-logo">
                <img src = "asset/logo.jpg" alt="ë¡œê³ ">    
            </div>
            <div class="footer-info">
                Â· í•˜ì´ì› ê·¸ëœë“œí˜¸í…” : ê°•ì›íŠ¹ë³„ìì¹˜ë„ ì •ì„ êµ° ì‚¬ë¶ì í•˜ì´ì›ê¸¸ 265<br>Â· í•˜ì´ì› íŒ°ë¦¬ìŠ¤í˜¸í…” : ê°•ì›íŠ¹ë³„ìì¹˜ë„ ì •ì„ êµ° ê³ í•œì ê³ í•œ7ê¸¸ 399<br>Â· ëŒ€í‘œë²ˆí˜¸ : 1588-7789<br>Â· ë©”ì¼ì£¼ì†Œ : webmaster@high1.com<br>Â· ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸ : 255-81-10770<br>Â· ì‹ ê³ í˜„í™© : í†µì‹ íŒë§¤ì—… ì‹ ê³  (ì œ2021-ê°•ì›ì •ì„ -0079í˜¸, ì œ2006-00011í˜¸)<br>Â· í†µì‹ íŒë§¤ì—… ì‹ ê³ ê¸°ê´€ëª… : ê°•ì›íŠ¹ë³„ìì¹˜ë„ ì •ì„ êµ°ì²­<br>Â· ëŒ€í‘œì´ì‚¬ : ì´ì‚¼ê±¸
            </div>
            <p class="footer-copy">COPYRIGHT(C) 2019 BY KANGWONLAND,INC. ALL RIGHTS RESERVED.</p>
        </div>
    </footer>`;
}

function toggleMenu() { 
    document.getElementById("sideMenu").classList.toggle("open"); 
}

// [1. ìˆ™ë°• ì˜ˆì•½ ë¦¬ìŠ¤íŠ¸ ë Œë”ë§]
function renderBookingContent(data = HOTEL_DATA) {
    let html = `
        <div style="margin-bottom:40px; border-left:4px solid #bd2aa4; padding-left:20px;">
            <h3 style="font-size:24px; font-weight:800; margin-bottom:10px;">ìˆ™ë°• ì˜ˆì•½</h3>
            <p style="color:#555;">ğŸ”ˆï¸[ì•Œ ë¦¼] ìˆ™ë°•í™•ì¸ì„œ, ì¸ë³´ì´ìŠ¤, ì¹´ë“œê²°ì œ ì˜ìˆ˜ì¦ì€ ìƒë‹¨ ë©”ì¸ ë©”ë‰´(â‰¡) ì¤‘ ì˜ˆì•½ì¡°íšŒì—ì„œ ì§ì ‘ ë°œê¸‰í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤. </p>
        </div>
        <div class="filters">
            <button class="filter-btn" onclick="sortHotels('low')">ê°€ê²© ë‚®ì€ìˆœ</button>
            <button class="filter-btn" onclick="sortHotels('high')">ê°€ê²© ë†’ì€ìˆœ</button>
        </div>
        <div class="hotel-grid">`;

    data.forEach(h => {
        html += `
            <div class="hotel-card">
                <div class="hotel-img" style="background-image:url('${h.img}')"></div>
                <div class="hotel-info">
                    <h3 style = "font-size: 18px; font-weight: 700 !important; margin: 0; white-space: nowrap; min-width: 0;">${h.name}</h3>
                    <p style="color:#f1c40f; margin-bottom:15px;">${h.star}</p>
                    <h4>${h.distance}</h4>
                    <hr style="border:0; border-top:1px solid #eee; margin:12px 0;">
                    <div style="text-align: right;">
                        <span class="price-tag">â‚© ${h.price.toLocaleString()}~</span>
                    </div>
                    <button class="btn-reserve" onclick="renderDetailView(${h.id})">ì˜ˆì•½í•˜ê¸°</button>
                </div>
            </div>`;
            
    });
    
    html += `</div>`;
    html += getFooter();
    document.getElementById("content-area").innerHTML = html;
}

function sortHotels(type) {
    const sorted = [...HOTEL_DATA].sort((a, b) => type === 'low' ? a.price - b.price : b.price - a.price);
    renderBookingContent(sorted);
}

// [2. í˜¸í…” ìƒì„¸ í˜ì´ì§€ ë Œë”ë§]
function renderDetailView(id) {
    const hotel = HOTEL_DATA.find(h => h.id == id);
    state.currentHotelId = id;
    window.scrollTo(0,0);
    document.getElementById('heroTitle').innerText = 'Title';
    document.getElementById('heroSub').innerText = 'Sub Title';
    document.getElementById('payment-bar').style.display = 'flex';

    let html = `
        <div class="section-card">
            <h2 style="font-size: 28px;">${hotel.name}</h2>
            <h3"><br>${hotel.engname}</h3>
            <div style="color: #ffb800; margin: 10px 0;">${hotel.star}</div>
            <p style="color: #666; font-size: 15px; margin-bottom: 20px;">${hotel.desc}</p>
            <img src="${hotel.img}" style="width:100%; height:400px; object-fit:cover; border-radius:15px;">
        </div>
        <div class="booking-layout">
            <div class="cal-box"><div class="section-card"><h3>ğŸ“… ì¼ì • ì„ íƒ</h3><div id="inline-calendar"></div></div></div>
            <div id="room-area" class="room-box section-card" style="opacity: 0.3; pointer-events: none;">
                <h3>ğŸ›ï¸ ê°ì‹¤ ë° ì˜µì…˜ ì„ íƒ</h3>
                <div id="room-list" style="margin-top:20px;"></div>
            </div>
        </div>
        <div class="section-card">
            <h3>
                <span style="color: #2ecc71; font-weight: bold;">ì²´í¬ì¸</span> 15:00 &nbsp;&nbsp; 
                <span style="color: #2ecc71; font-weight: bold;">ì²´í¬ì•„ì›ƒ</span> 11:00
            </h3>
            <div style="display:grid; grid-template-columns: 1.5fr 1fr; gap:30px; margin-top:20px;">
                <iframe class="map-frame" src="https://maps.google.com/maps?q=${encodeURIComponent(hotel.location)}&t=&z=14&ie=UTF8&iwloc=&output=embed" frameborder="0"></iframe>
                <ul style="list-style:none;">
                    <li style="margin-bottom:15px;"><strong>ì£¼ì†Œ:</strong> ${hotel.location}</li>
                    <li style="margin-bottom:15px;"><strong>ì „í™” ë²ˆí˜¸:</strong> ${hotel.tel || '02-1234-5678'}</li>
                    <li style="margin-bottom:15px;"><strong>íŒ©ìŠ¤ ë²ˆí˜¸:</strong>
                    <li><strong>í™ˆí˜ì´ì§€:</strong> <a href="https://www.high1.com/www/index.do" style="color:#bd2aa4; text-decoration:none; font-weight:700;">ë°”ë¡œê°€ê¸°</a></li>
                </ul>
            </div>
        

        </div>`;

    html += getFooter();    
    document.getElementById('content-area').innerHTML = html;

// [2. í˜¸í…” ìƒì„¸ í˜ì´ì§€ ë Œë”ë§ ë‚´ room-list ìƒì„± ë¶€ë¶„]
const list = document.getElementById('room-list');
list.innerHTML = ''; // ê¸°ì¡´ ë¦¬ìŠ¤íŠ¸ ì´ˆê¸°í™”

// ìˆ™ë°• ê¸°ê°„ í…ìŠ¤íŠ¸ ìƒì„± (ì„ íƒëœ ë‚ ì§œ ê¸°ë°˜)
Object.entries(hotel.roomPrices).forEach(([type, price]) => {
    const cleanId = type.replace(/\s/g, '');
    
    const specificLink = (hotel.roomLinks && hotel.roomLinks[type]) 
                         ? hotel.roomLinks[type]
                         :"https://www.high1.com";
    // 1. ê°ì‹¤ íƒ€ì…ë³„ ì¸ì› ì„¤ì • (ì˜ë„í•˜ì‹  ë¶€ë¶„)
    let capacity = "";
    if (type.includes("íŠ¸ë¦¬í”Œ")) {
        capacity = "ê¸°ì¤€ì¸ì› 3ëª… / ìµœëŒ€ì¸ì› 3ëª…";
    } else if (type.includes("ë”ë¸”") || type.includes("íŠ¸ìœˆ")) {
        capacity = "ê¸°ì¤€ì¸ì› 2ëª… / ìµœëŒ€ì¸ì› 2ëª…";
    } else if (type.includes("íŒ¨ë°€ë¦¬") || type.includes("ì˜¨ëŒ")) {
        capacity = "ê¸°ì¤€ì¸ì› 4ëª… / ìµœëŒ€ì¸ì› 4ëª…";
    } else if (type.includes("ë””ëŸ­ìŠ¤") || type.includes("ê·¸ëœë“œ")) {
        capacity = "ê¸°ì¤€ì¸ì› 5ëª… / ìµœëŒ€ì¸ì› 7ëª…";
    } else {
        capacity = "ê¸°ì¤€ì¸ì› 2ëª… / ìµœëŒ€ì¸ì› 2ëª…"; // ê¸°ë³¸ê°’
    }

    const roomNotice = `${capacity}`; // í™”ë©´ì— í‘œì‹œë  ë¬¸êµ¬

    // 2. ë‚ ì§œ ì •ë³´ (ëª‡ ë°•, ë©°ì¹ ~ë©°ì¹ )
    const dateInfo = state.nights > 0 
        ? `${state.nights}ë°• (${state.checkIn} ~ ${state.checkOut})` 
        : "ë‚ ì§œë¥¼ ì„ íƒí•´ ì£¼ì„¸ìš”";

    list.innerHTML += `
        <div class="room-card" id="card-${cleanId}" onclick="selRoom('${type}', ${price})">
            <img src="${hotel.roomImgs[type] || hotel.img}" class="room-img-sm">
            <div style="flex:1">
                <h4>${type}</h4>
                <div style="color:#bd2aa4; font-weight:700; margin-top:4px;">â‚©${price.toLocaleString()}</div>
            </div>
            <div>â¯</div>
        </div>

        <div class="option-panel" id="panel-${cleanId}">
            <div style="padding: 10px 20px 5px 20px;">
                <div style="font-size:13px; color:#555; margin-bottom:4px; font-weight:600;">ğŸ‘¥ ${capacity}</div>
                <div class="date-info-text" style="font-size:13px; color:#bd2aa4; font-weight:600;">
                    ğŸ“… ${state.nights > 0 ? state.nights + 'ë°• (' + state.checkIn + ' ~ ' + state.checkOut + ')' : 'ë‚ ì§œë¥¼ ì„ íƒí•´ ì£¼ì„¸ìš”'}
                </div>
            </div>
        
          <div class="inner-acc">
            <div class="inner-acc-head" onclick="toggleAcc(this)">
              <span>ê°ì‹¤ ìƒì„¸ë³´ê¸°</span>
              <span>â–¼</span>
            </div>
            <div class="inner-acc-body">
              <div style="margin-bottom:10px; line-height:1.6;">${hotel.desc_detail}</div>
              <hr style="margin:10px 0; border:0; border-top:1px solid #eee;">
              <a href="${specificLink}" target="_blank" style="color:#bd2aa4; text-decoration:underline; font-size:13px;">
                >> ê°ì‹¤ ìì„¸íˆ ë³´ê¸°
              </a>
            </div>
          </div>
          <div class="counter-row"><span>ê°ì‹¤ ìˆ˜ëŸ‰</span><div class="cnt-btns"><button onclick="cnt('g',-1)">-</button><strong class="g-cnt">1</strong><button onclick="cnt('g',1)">+</button></div></div>
          <div class="counter-row"><span>ì¶”ê°€ ì¡°ì‹(1ì¸/ë°•ë‹¹)</span><div class="cnt-btns"><button onclick="cnt('b',-1)">-</button><strong class="b-cnt">0</strong><button onclick="cnt('b',1)">+</button></div></div>
        </div>`;
});

    flatpickr("#inline-calendar", { mode: "range", inline: true, onChange: (dates) => { 
        if(dates.length===2) { 
            state.nights = Math.ceil(Math.abs(dates[1]-dates[0])/86400000); 
            // [ì¶”ê°€] ì‹œì‘ì¼ê³¼ ì¢…ë£Œì¼ì„ stateì— ì €ì¥
            state.checkIn = dates[0].toLocaleDateString();
            state.checkOut = dates[1].toLocaleDateString();
            document.getElementById('room-area').style.opacity="1"; 
            document.getElementById('room-area').style.pointerEvents="auto";
            updateRoomDateInfo();
            updateUI(); 
        } 
    }});
}

function updateRoomDateInfo() {
    // ëª¨ë“  ê°ì‹¤ ì¹´ë“œì˜ ë‚ ì§œ ì •ë³´ê°€ ë“¤ì–´ê°€ëŠ” divë¥¼ ì°¾ì•„ì„œ ê¸€ìë§Œ ë°”ê¿‰ë‹ˆë‹¤.
    // (ì´ ê¸°ëŠ¥ì„ ì“°ë ¤ë©´ HTML ìƒì„± ì‹œ í•´ë‹¹ ë¶€ë¶„ì— class="date-info-text"ë¥¼ ë„£ì–´ì¤˜ì•¼ í•©ë‹ˆë‹¤)
    const dateElements = document.querySelectorAll('.date-info-text');
    const newText = `ğŸ“… ${state.nights}ë°• (${state.checkIn} ~ ${state.checkOut})`;
    
    dateElements.forEach(el => {
        el.innerText = newText;
    });
}

function selRoom(type, price) {
    const cleanId = type.replace(/\s/g, '');
    const targetPanel = document.getElementById(`panel-${cleanId}`);
    const targetCard = document.getElementById(`card-${cleanId}`);

    // í˜„ì¬ í´ë¦­í•œ íŒ¨ë„ì´ ì´ë¯¸ ì—´ë ¤ìˆëŠ”ì§€ í™•ì¸
    const isOpen = targetPanel.classList.contains('show');

    // 1. ëª¨ë“  íŒ¨ë„ê³¼ ì¹´ë“œë¥¼ ì´ˆê¸°í™” (ì¼ë‹¨ ë‹¤ ë‹«ê¸°)
    document.querySelectorAll('.option-panel').forEach(p => p.classList.remove('show'));
    document.querySelectorAll('.room-card').forEach(c => c.classList.remove('active'));

    // 2. ì´ë¯¸ ì—´ë ¤ìˆë˜ ê²Œ ì•„ë‹ˆë¼ë©´ ìƒˆë¡œ ì—´ê¸°
    if (!isOpen) {
        targetPanel.classList.add('show');
        targetCard.classList.add('active');
        state.roomPrice = price;
        state.roomType = type;
    } else {
        // ì´ë¯¸ ì—´ë ¤ìˆë˜ ê±¸ ë‹¤ì‹œ ëˆŒë €ë‹¤ë©´ ë‹«íŒ ìƒíƒœ ìœ ì§€í•˜ê³  ê°€ê²© ì´ˆê¸°í™”
        state.roomPrice = 0;
        state.roomType = "";
    }

    updateUI();
}

function cnt(t, v) {
    if(t==='g') state.guests = Math.min(10, Math.max(1, state.guests+v));
    else state.bf = Math.max(0, state.bf+v);
    document.querySelectorAll('.g-cnt').forEach(el => el.innerText = state.guests);
    document.querySelectorAll('.b-cnt').forEach(el => el.innerText = state.bf);
    updateUI();
}

function updateUI() {
    // ìˆ˜ì‹: ((ê°ì‹¤ê°€ê²© * íˆ¬ìˆ™ì¸ì›) + (ì¡°ì‹ê°€ê²© * ì¡°ì‹ì¸ì›)) * ìˆ™ë°•ì¼ìˆ˜
    const total = (state.nights > 0 && state.roomPrice > 0) 
                  ? ((state.roomPrice * state.guests) + (state.bf * 20000)) * state.nights 
                  : 0;
    
    document.getElementById('totalAmount').innerText = total.toLocaleString();
}

// [3. ë©”ì¸ ì„¹ì…˜ ì „í™˜ ê¸°ëŠ¥]
function showSection(key) {
    const area = document.getElementById("content-area");
    document.getElementById('payment-bar').style.display = 'none';
    document.getElementById('heroTitle').innerText = SECTION_TITLE[key].title;
    document.getElementById('heroSub').innerText = SECTION_TITLE[key].sub;

    if (key === 'booking') {
        renderBookingContent();
    } else if (key === 'login') {
        area.innerHTML = `
            <div class="sub-card">
                <h2 style="margin-bottom:20px; font-weight:800;">ë¡œê·¸ì¸</h2>
                <p style="margin-bottom:25px; color:#666; font-size:14px;">ì´ë©”ì¼ê³¼ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.</p>
                <input type="text" id="loginId" class="input-field" placeholder="ì´ë©”ì¼">
                <input type="password" id="loginPw" class="input-field" placeholder="ë¹„ë°€ë²ˆí˜¸">
                <button class="btn-reserve" style="background:#bd2aa4; margin-top:20px;" onclick="checkLogin()">ì¡°íšŒí•˜ê¸°</button>
                <div style="margin-top:20px; font-size:13px; color:#888;">
                    <a href="#" style="color:#888; text-decoration:none; margin:0 10px;">ë¹„ë°€ë²ˆí˜¸ ì°¾ê¸°</a>
                </div>
            </div>`;
    } else if (key === 'cs') {
        area.innerHTML = `
            <div class="sub-card" style="max-width:800px; padding:0; overflow:hidden;">
                <img src="https://images.unsplash.com/photo-1521737711867-e3b97375f902?auto=format&fit=crop&w=800&q=80" style="width:100%;">
            </div>`;
    } else if (key === 'faq') {
        renderFaqContent();
    }
    
    const sideMenu = document.getElementById("sideMenu");
    if(sideMenu.classList.contains("open")) sideMenu.classList.remove("open");
    window.scrollTo(0,0);
}

// [4. ì˜ˆì•½ ì¡°íšŒ ë° ë¡œê·¸ì¸ ì²˜ë¦¬]
async function checkLogin() {
    const email = document.getElementById('loginId').value;
    const pw = document.getElementById('loginPw').value;

    // 1. ê´€ë¦¬ì ê³„ì • í•˜ë“œì½”ë”© ì²´í¬ (DB ì—°ë™ ì „ í…ŒìŠ¤íŠ¸ìš©)
    if (email === "admin" && pw === "1234") {
        alert("ê´€ë¦¬ì ëª¨ë“œë¡œ ì ‘ì†í•©ë‹ˆë‹¤.");
        document.getElementById('heroTitle').innerText = "ê´€ë¦¬ì ì‹œìŠ¤í…œ";
        document.getElementById('heroSub').innerText = "ì˜ˆì•½ ë‚´ì—­ ë° í˜„í™©";
        
        // 2. ë°”ë¡œ ê´€ë¦¬ì í™”ë©´ì„ ê·¸ë ¤ë²„ë¦¼ (showSection ê±°ì¹˜ì§€ ì•ŠìŒ)
        renderAdminContent(); 
        return;
    }

    try {
        const response = await fetch('/api/check-reservation', { 
            method:'POST', 
            headers:{'Content-Type':'application/json'}, 
            body:JSON.stringify({email, password:pw}) 
        });
        
        const result = await response.json();
        
        if (result.success) {
            const row = result.data;
            sessionStorage.setItem('loggedInUser', JSON.stringify({ name: row.guestName, role: 'user' }));
            updateHeader();

            const area = document.getElementById('content-area');
            document.getElementById('heroTitle').innerText = "ì˜ˆì•½ ë‚´ì—­";
            document.getElementById('heroSub').innerText = "ê³ ê°ë‹˜ì˜ ì˜ˆì•½ ì •ë³´ë¥¼ í™•ì¸í•˜ì„¸ìš”.";

            area.innerHTML = `
                <div class="section-card" style="max-width:700px; margin:0 auto;">
                    <h2 style="margin-bottom:20px;">${row.guestName}ë‹˜ì˜ ì˜ˆì•½</h2>
                    <div style="border:1px solid #eee; border-radius:10px; padding:20px; background:#fff;">
                        <p style="margin-bottom:8px;"><strong>ì˜ˆì•½ë²ˆí˜¸:</strong> ${row.id}</p>
                        <p style="margin-bottom:8px;"><strong>í˜¸í…”ëª…:</strong> ${row.hotelName}</p>
                        <p style="margin-bottom:8px;"><strong>ì²´í¬ì¸ ë‚ ì§œ:</strong> ${row.checkIn}</p>
                        <p style="margin-bottom:8px;"><strong>ê²°ì œ ê¸ˆì•¡:</strong> â‚© ${Number(row.totalPrice || 0).toLocaleString()}</p>
                        <p style="margin-bottom:8px;"><strong>ì´ë©”ì¼:</strong> ${row.guestEmail}</p>
                    </div>
                    <div style="margin-top:20px; display:flex; gap:10px;">
                        <button class="filter-btn" onclick="showSection('booking')">ë‹¤ë¥¸ ê°ì‹¤ ì˜ˆì•½í•˜ê¸°</button>
                    </div>
                </div>
                ${getFooter()}
            `;
        } else {
            alert(result.message);
        }
    } catch (error) {
        console.error("ë¡œê·¸ì¸ ì—ëŸ¬:", error);
        alert("ì„œë²„ ì—°ê²°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");
    }
}

function updateHeader() {
    const userJson = sessionStorage.getItem('loggedInUser');
    const authArea = document.getElementById('auth-area');
    if (userJson && authArea) {
        const user = JSON.parse(userJson);
        authArea.innerHTML = `
            <span style="font-size:14px;"><b>${user.name}</b>ë‹˜</span>
            <button onclick="handleLogout()" style="padding:4px 8px; font-size:11px; margin-left:10px; cursor:pointer;">ë¡œê·¸ì•„ì›ƒ</button>`;
    }
}

function handleLogout() {
    sessionStorage.removeItem('loggedInUser');
    alert("ë¡œê·¸ì•„ì›ƒ ë˜ì—ˆìŠµë‹ˆë‹¤.");
    location.reload();
}

// [5. FAQ ê²€ìƒ‰ ê¸°ëŠ¥]
function renderFaqContent(query = '') {
    const q = query.toLowerCase();
    const filtered = FAQ_DATA.filter(item => 
        item.q.toLowerCase().includes(q) || item.a.toLowerCase().includes(q)
    );
    
    let html = `
        <div class="faq-search-wrap">
            <input oninput="renderFaqContent(this.value)" class="faq-search" placeholder="ê¶ê¸ˆí•œ ë‚´ìš©ì„ ê²€ìƒ‰í•˜ì„¸ìš”" value="${query}">
        </div>
        <div style="max-width:800px; margin: 0 auto;">`;
    
    if (filtered.length === 0) {
        html += `<div style="padding: 30px 0; color:#888; text-align:center;">ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.</div>`;
    } else {
        filtered.forEach((item, index) => {
            html += `
                <div style="background:#fff; border-radius:12px; margin-bottom:10px; padding:20px; cursor:pointer; border:1px solid #eee;" 
                     onclick="this.children[1].style.display=this.children[1].style.display==='none'?'block':'none'">
                    <div style="font-weight:700;">Q. ${item.q}</div>
                    <div style="display:none; margin-top:15px; color:#666; line-height:1.6; background:#f9f9f9; padding:15px; border-radius:10px;">
                        A. ${item.a}
                    </div>
                </div>`;
        });
    }
    html += getFooter();
    document.getElementById("content-area").innerHTML = html + `</div>`;
}

function toggleAcc(el) {
    // í´ë¦­ ì´ë²¤íŠ¸ê°€ ë¶€ëª¨ ë£¸ì¹´ë“œë¡œ í¼ì ¸ì„œ ì¹´ë“œê°€ ë‹«íˆëŠ” ê²ƒì„ ë°©ì§€
    if (window.event) window.event.stopPropagation();
    
    const body = el.nextElementSibling;
    body.classList.toggle('open');
    
    const icon = el.querySelector('span:last-child');
    icon.innerText = body.classList.contains('open') ? 'â–²' : 'â–¼';
}

function toggleNested(el, isDeep = false) {
  // ë²„ë¸”ë§ ë°©ì§€ : í´ë¦­ì´ ë¶€ëª¨ 'room-card'ë¡œ ì „ë‹¬ë˜ì–´ ì„ íƒì´ í•´ì œ ë˜ëŠ” ê²ƒì„ ë§‰ìŒ
  if (window.event) window.event.stopPropagation();

  const body= el.nextElementSibling;
  body.classList.toggle('open');

  const icon= el.querySelector('span:last-child');
  if (isDeep) {
    icon.innerText = body.classList.contains('open') ? '-' : '+';
  } else {
    icon.innerText = body.classList.contains('open') ? 'â–²' : 'â–¼';
  }
}

//ê´€ë¦¬ì í˜ì´ì§€
function renderAdminContent(){
    // 2. ê´€ë¦¬ì ì „ìš© ë ˆì´ì•„ì›ƒ ìƒì„± (admin.htmlì˜ ìŠ¤íƒ€ì¼ ì´ì‹)
    let html = `
        <div class="admin-container">
            <div class="admin-header" style="display:flex; justify-content:space-between; margin-bottom:20px;">
                <h2 style="color:#bd2aa4;">ğŸ“‹ ì „ì²´ ì˜ˆì•½ í†µê³„</h2>
                <button class="btn-excel" onclick="downloadExcel()">ğŸ“Š ì—‘ì…€ ì €ì¥</button>
            </div>
            
            <div class="stats-row" style="display:grid; grid-template-columns:1fr 1fr 1fr; gap:15px; margin-bottom:30px;">
                <div class="stat-card" style="background:#fff; padding:20px; border-radius:12px; border:1px solid #eee; text-align:center;">
                    <p style="font-size:13px; color:#888;">ì´ ì˜ˆì•½</p>
                    <h3 id="total-count" style="color:#333;">0ê±´</h3>
                </div>
                <div class="stat-card" style="background:#fff; padding:20px; border-radius:12px; border:1px solid #eee; text-align:center;">
                    <p style="font-size:13px; color:#888;">ëˆ„ì  ë§¤ì¶œ</p>
                    <h3 id="total-revenue" style="color:#bd2aa4;">â‚© 0</h3>
                </div>
                <div class="stat-card" style="background:#fff; padding:20px; border-radius:12px; border:1px solid #eee; text-align:center;">
                    <p style="font-size:13px; color:#888;">ì„œë²„ ìƒíƒœ</p>
                    <h3 style="color:#27ae60;">Active</h3>
                </div>
            </div>

            <table class="admin-table" style="width:100%; border-collapse:collapse; background:#fff; border-radius:12px; overflow:hidden;">
                <thead style="background:#f8f9fb;">
                    <tr>
                        <th style="padding:15px; text-align:left;">ì˜ˆì•½ë²ˆí˜¸</th>
                        <th style="padding:15px; text-align:left;">ì˜ˆì•½ì</th>
                        <th style="padding:15px; text-align:left;">í˜¸í…”ì •ë³´</th>
                        <th style="padding:15px; text-align:left;">ê¸ˆì•¡</th>
                        <th style="padding:15px; text-align:center;">ê´€ë¦¬</th>
                    </tr>
                </thead>
                <tbody id="admin-table-body"></tbody>
            </table>
        </div>
    `;

    // ì‹¤ì œ í™”ë©´ì— ì£¼ì…
    html += getFooter();
    document.getElementById("content-area").innerHTML = html;
    
    // ë°ì´í„° ë¡œë“œ í•¨ìˆ˜ í˜¸ì¶œ (admin.htmlì— ìˆë˜ ê·¸ ë¡œì§)
    loadAdminData();
}

async function loadAdminData() {
    const tbody = document.getElementById('admin-table-body');
    let totalRevenue = 0;

    try {
        const response = await fetch('/api/reservations');
        const data = await response.json();

        if (!Array.isArray(data) || data.length === 0) {
            tbody.innerHTML = '<tr><td colspan="5" style="text-align:center; padding:50px; color:#999;">ì˜ˆì•½ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.</td></tr>';
            document.getElementById('total-count').innerText = "0ê±´";
            document.getElementById('total-revenue').innerText = "â‚© 0";
            return;
        }

        tbody.innerHTML = data
            .slice()
            .reverse()
            .map(item => {
                const priceNum = parseInt(String(item.totalPrice).replace(/[^0-9]/g, '')) || 0;
                totalRevenue += priceNum;
                return `
            <tr style="border-top:1px solid #eee;">
                <td style="padding:15px; font-size:14px;">${item.id}</td>
                <td style="padding:15px;"><strong>${item.guestName || ''}</strong><br><span style="font-size:12px; color:#888;">${item.guestEmail || ''}</span></td>
                <td style="padding:15px; font-size:14px;">${item.hotelName || ''}<br><span style="font-size:12px; color:#888;">${item.checkIn || ''}</span></td>
                <td style="padding:15px; font-weight:700; color:#bd2aa4;">${priceNum.toLocaleString()}</td>
                <td style="padding:15px; text-align:center;">
                    <button onclick="deleteRes('${item.id}')" style="color:#ff4d4d; border:1px solid #ff4d4d; background:none; padding:4px 8px; border-radius:4px; cursor:pointer;">ì‚­ì œ</button>
                </td>
            </tr>`;
            }).join('');

        document.getElementById('total-count').innerText = data.length + "ê±´";
        document.getElementById('total-revenue').innerText = "â‚© " + totalRevenue.toLocaleString();
    } catch (error) {
        console.error("ê´€ë¦¬ì ë°ì´í„° ë¡œë“œ ì—ëŸ¬:", error);
        tbody.innerHTML = '<tr><td colspan="5" style="text-align:center; padding:50px; color:#e74c3c;">ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.</td></tr>';
    }
}

async function deleteRes(id) {
    if (!confirm('ì •ë§ë¡œ ì´ ì˜ˆì•½ ë‚´ì—­ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;

    try {
        const response = await fetch(`/api/reserve/${id}`, {
            method: 'DELETE'
        });

        if (!response.ok) {
            const result = await response.json().catch(() => ({}));
            alert(result.error || "ì˜ˆì•½ ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
            return;
        }

        loadAdminData();
    } catch (error) {
        console.error("ì‚­ì œ ìš”ì²­ ì—ëŸ¬:", error);
        alert("ì„œë²„ì™€ í†µì‹  ì¤‘ ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
    }
}


    // ì—‘ì…€(CSV) ë‹¤ìš´ë¡œë“œ ê¸°ëŠ¥
    function downloadExcel() {
        const data = JSON.parse(localStorage.getItem('reservations') || '[]');
        if(data.length === 0) { alert('ë‹¤ìš´ë¡œë“œí•  ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.'); return; }

        let csv = "\uFEFF"; // í•œê¸€ ê¹¨ì§ ë°©ì§€ BOM
        csv += "ì˜ˆì•½ë²ˆí˜¸,ì‹ ì²­ì¼ì‹œ,ì´ë¦„(êµ­ë¬¸),ì´ë¦„(ì˜ë¬¸),ì†Œì†,ì—°ë½ì²˜,ì´ë©”ì¼,í˜¸í…”ëª…,ê°ì‹¤íƒ€ì…,ìˆ™ë°•ê¸°ê°„,ê²°ì œê¸ˆì•¡\n";

        data.forEach(item => {
            csv += `"${item.id}","${item.orderDate}","${item.guestName}","${item.guestNameEn}","${item.guestAff}","${item.guestPhone}","${item.guestEmail}","${item.hotelName}","${item.roomType}","${item.dateRange}","${item.totalPrice.replace(/,/g,'')}"\n`;
        });

        const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
        const link = document.createElement("a");
        const url = URL.createObjectURL(blob);
        link.setAttribute("href", url);
        link.setAttribute("download", `IMWA2026_ì˜ˆì•½ëª…ë‹¨_${new Date().toLocaleDateString()}.csv`);
        link.style.visibility = 'hidden';
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
        URL.revokeObjectURL(url);
    }

//ì„¹ì…˜ ë‚´ êµ­ì  ì„ íƒ í˜ì´ì§€ 
const countryOptions = COUNTRY_DATA.map(c => `<option value="${c.code}">${c.name}</option>`).join('');

//ìƒì„¸ ê²°ì œ í˜ì´ì§€ 
function renderPaymentView() {
    const hotel = HOTEL_DATA.find(h => h.id == state.currentHotelId);
    // 0. ë°©ì–´ ë¡œì§ (ë‚ ì§œ/ê°ì‹¤ ë¯¸ì„ íƒ ì‹œ)
    if (state.nights === 0 || state.roomPrice === 0) {
        alert("ì¼ì • ë° ê°ì‹¤ì„ ë¨¼ì € ì„ íƒí•´ ì£¼ì„¸ìš”.");
        return;
    }

    // 1. ìƒë‹¨ ë°°ë„ˆ ë° ìƒíƒœê°’ ì„¤ì •
    document.getElementById('heroTitle').innerText = "Booking & Payment";
    document.getElementById('heroSub').innerText = "ì•ˆì „í•œ ê²°ì œë¥¼ ìœ„í•´ ì •ë³´ë¥¼ ì •í™•íˆ ì…ë ¥í•´ì£¼ì„¸ìš”.";
    document.getElementById('payment-bar').style.display = 'none';

    // 2. í¼ ë Œë”ë§ ì‹œì‘
    let html = `
    <div style="max-width: 900px; margin: 0 auto; display: flex; flex-direction: column; gap: 30px;">
        
        <div class="section-card">
            <h3 style="margin-bottom:20px;">ğŸ¨ ì£¼ìš” ì •ë³´</h3>
            <div style="gap:20px; margin-bottom:20px;">
                
                <img src="${hotel?.roomImgs?.[state.roomType] || hotel?.img || ''}" style="width:830px; height:450px; border-radius:10px; object-fit:cover;display: block;">
                <div>
                    <br><h4 style = "font-size: 28px; font-weight: 800; color: #333; margin-bottom: 20px; letter-spacing: -1px;">${HOTEL_DATA.find(h => h.id === state.currentHotelId)?.name}<br>${state.roomType}</h4>
                    <p style="font-size: 16px; color: #333; font-weight: 600;"><br>${state.nights}ë°•<br><br>ì²´í¬ì¸: ${state.checkIn || '-'}<br><br>ì²´í¬ì•„ì›ƒ: ${state.checkOut || '-'}</p>
                    <p style="font-size: 16px; color: #333; font-weight: 600;"><br>ì¡°ì‹ ì¶”ê°€: ${state.bf}ê°œ</p>
                </div>
            </div>
            <div style="margin: 20px 0; border: 1px solid #eee; border-radius: 10px; background: #fff; overflow: hidden;">
                <div style="padding: 15px 20px; background: #fafafa; border-bottom: 1px solid #eee; font-weight: bold; color: #333; display: flex; align-items: center; gap: 8px;">
                    ğŸ” ê°ì‹¤ ì„¸ë¶€ ì„¤ëª… ë° ì´ìš© ì•ˆë‚´
                </div>
    
                <div style="padding: 20px; font-size: 14px; color: #666; line-height: 1.8; max-height: 400px; overflow-y: auto;">
                    ${HOTEL_DATA.find(h => h.id === state.currentHotelId)?.desc_detail || 'ê°ì‹¤ ìƒì„¸ ì •ë³´ê°€ ì¤€ë¹„ ì¤‘ì…ë‹ˆë‹¤.'}
                </div>
            </div>
            <div style="padding:15px; background:#fdf5fc; border:1px solid #bd2aa4; border-radius:10px; color:#bd2aa4; font-weight:600;">
                âœ… ë¬´ë£Œì·¨ì†Œ ê°€ëŠ¥ ê¸°ê°„: ${state.checkIn ? getCancelDate(state.checkIn) : 'ì²´í¬ì¸ 3ì¼ ì „'}ê¹Œì§€
            </div>
        </div>

        <div class="section-card">
            <h3 style="margin-bottom:20px;">ğŸ”‘ ë¡œê·¸ì¸ ì •ë³´</h3>
            <div style="display:grid; grid-template-columns:1fr 1fr; gap:15px;">
                <input type="email" id ="loginEmail" class="input-field" placeholder="ì´ë©”ì¼">
                <input type="password" id = "loginPw" class="input-field" placeholder="ë¹„ë°€ë²ˆí˜¸">
                <input type="password" id = "loginPwConfirm" class="input-field" placeholder="ë¹„ë°€ë²ˆí˜¸ í™•ì¸">
                <button type="button" class="filter-btn" style="height:50px; margin-top:10px;" onclick="validateLogin()">ë¡œê·¸ì¸ì •ë³´ í™•ì¸í•˜ê¸°</button>
            </div>
            <div id="loginMsg" style="margin-top:10px; font-size:14px; font-weight:bold;"></div>
        </div>

        <div class="section-card">
            <h3 style="margin-bottom:20px;">ğŸ‘¤ ëŒ€í‘œ ì˜ˆì•½ì</h3>
            <div id="master-info" style="display:grid; grid-template-columns:1fr 1fr; gap:15px;">
                <input type="text" class="input-field master-name" placeholder="ì„±ëª…">
                <input type="text" class="input-field master-birth" placeholder="ë²•ì •ìƒë…„ì›”ì¼ (6ìë¦¬)">
                <input type="tel" class="input-field master-phone" placeholder="ì—°ë½ì²˜">
                <input type="email" class="input-field master-email" placeholder="ì´ë©”ì¼">
                <select class="input-field master-nation">
                    ${countryOptions}
                </select>
            </div>
        </div>

        <div class="section-card">
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
                <h3>ğŸ›ï¸ ê°ì‹¤ ì˜ˆì•½ì</h3>
                <label style="font-size:14px;"><input type="checkbox" onchange="copyGuestInfo(this)"> ëŒ€í‘œì˜ˆì•½ìì™€ ë™ì¼</label>
            </div>
            <div id="guest-list">
                <div class="guest-item" style="border:1px solid #eee; padding:15px; border-radius:10px; margin-bottom:10px;">
                    <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px;">
                        <input type="text" class="input-field g-name" placeholder="ì„±ëª…">
                        <input type="text" class="input-field g-birth" placeholder="ë²•ì •ìƒë…„ì›”ì¼">
                        <input type="tel" class="input-field g-phone" placeholder="ì—°ë½ì²˜">
                        <input type="email" class="input-field g-email" placeholder="ì´ë©”ì¼">
                        <select class="input-field g-nation">
                            ${countryOptions}
                        </select>
                    </div>
                </div>
            </div>
            <button class="filter-btn" style="width:100%;" onclick="addGuest()">+ ì—¬í–‰ì ì¶”ê°€</button>
        </div>

        <div class="section-card" style="background: #fff; border: 1px solid #e1e4e9; padding: 30px; border-radius: 8px; margin-bottom: 25px;">
            <h3 style="margin-bottom:20px; border-left: 4px solid #bd2aa4; padding-left: 15px;">ğŸ“„ ì•½ê´€ ë™ì˜</h3>
            <div style="text-align:left; background:#f8f9fb; padding:20px; border-radius:10px; border: 1px solid #eee;">
                <label style="font-weight:bold; display:block; margin-bottom:10px; cursor:pointer;">
                    <input type="checkbox" id="all-check" onclick="allAgree(this)"> ëª¨ë‘ ë™ì˜
                </label>
                <hr style="margin-bottom:12px; border:0; border-top:1px solid #ddd;">
        
                <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:8px;">
                    <label style="font-size:15px; cursor:pointer;"><input type="checkbox" class="agree-chk"> ê°œì¸ì •ë³´ ìˆ˜ì§‘ ë° ì´ìš© ë™ì˜ (í•„ìˆ˜)</label>
                    <span style="font-size:12px; color:#999; text-decoration:underline; cursor:pointer;" onclick="showTerms('privacy')">ì „ë¬¸ë³´ê¸°</span>
                </div>

                <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:8px;">
                    <label style="font-size:15px; cursor:pointer;"><input type="checkbox" class="agree-chk"> ê³ ìœ ì‹ë³„ì •ë³´ ìˆ˜ì§‘ ì´ìš© ë™ì˜ (í•„ìˆ˜)</label>
                    <span style="font-size:12px; color:#999; text-decoration:underline; cursor:pointer;" onclick="showTerms('identification')">ì „ë¬¸ë³´ê¸°</span>
                </div>

                <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:8px;">
                    <label style="font-size:15px; cursor:pointer;"><input type="checkbox" class="agree-chk"> ê°œì¸ì •ë³´ ìœ„íƒ ë™ì˜ (í•„ìˆ˜)</label>
                    <span style="font-size:12px; color:#999; text-decoration:underline; cursor:pointer;" onclick="showTerms('consignment')">ì „ë¬¸ë³´ê¸°</span>
                </div>

                <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:8px;">
                    <label style="font-size:15px; cursor:pointer;"><input type="checkbox" class="agree-chk"> ê°œì¸ì •ë³´ ì œ3ì ì œê³µ ë™ì˜ (í•„ìˆ˜)</label>
                    <span style="font-size:12px; color:#999; text-decoration:underline; cursor:pointer;" onclick="showTerms('thirdparty')">ì „ë¬¸ë³´ê¸°</span>
                </div>
            </div>
        </div>

<div id="termsModal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5); z-index:9999; justify-content:center; align-items:center;">
    <div style="background:#fff; width:90%; max-width:500px; padding:30px; border-radius:10px; position:relative;">
        <h4 id="termsTitle" style="margin-bottom:15px;">ì•½ê´€ ì „ë¬¸</h4>
        <div id="termsContent" style="height:300px; overflow-y:auto; border:1px solid #eee; padding:15px; font-size:13px; color:#666; line-height:1.6; white-space:pre-wrap;"></div>
        <button onclick="closeTerms()" style="width:100%; margin-top:20px; height:45px; background:#333; color:#fff; border:none; border-radius:5px; cursor:pointer;">ë‹«ê¸°</button>
    </div>
</div>

        <div class="section-card" style="background:#fff; border:1px solid #ddd; padding:30px; border-radius:10px;">
            <h3 style="margin-bottom:20px; border-left: 4px solid #bd2aa4; padding-left: 15px;">ğŸ’³ ê²°ì œ ì •ë³´</h3>
            
            <div style="background: #fdf5fc; border: 1px solid #fae1f5; padding: 20px; border-radius: 8px; margin-bottom: 20px;">
                <label style="display: flex; align-items: flex-start; gap: 10px; font-weight: bold; font-size: 14.5px; color: #333; cursor: pointer; margin-bottom: 12px;">
                    <input type="checkbox" style="margin-top: 4px;"> 
                    <span>ì˜ˆì•½ í›„ ê²°ì œ ì¹´ë“œ ë³€ê²½ ë˜ëŠ” ì²´í¬ì•„ì›ƒ ë‚ ì§œ ì´ì „ê¹Œì§€ ì˜¨ë¼ì¸ ì¬ê²°ì œë¥¼ ì›í•˜ì‹œë©´ ì„ íƒí•˜ì„¸ìš”.</span>
                </label>
                <ul style="margin: 0; padding-left: 18px; list-style-type: none; font-size: 13px; color: #666; line-height: 1.7;">
                    <li style="margin-bottom: 5px;">â€¢ ë¨¼ì €, ì•„ë˜ ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ <strong>ì „ì•¡ ì„ ê²°ì œ</strong>ë¥¼ ì™„ë£Œí•´ ì£¼ì„¸ìš”.</li>
                    <li style="margin-bottom: 5px;">â€¢ ì²´í¬ì•„ì›ƒ ë‚ ì§œ ì´ì „ê¹Œì§€ <strong>ì¹´ë“œ ë³€ê²½ ë° ì¬ê²°ì œ</strong>ê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤. (í˜¸í…” í”„ëŸ°íŠ¸ ë¶ˆê°€)</li>
                    <li style="margin-bottom: 0;">â€¢ ì˜¨ë¼ì¸ ì¬ê²°ì œê°€ ì™„ë£Œë˜ë©´ <strong>ê¸°ì¡´ ì„ ê²°ì œ ê¸ˆì•¡ì€ ìë™ìœ¼ë¡œ ì·¨ì†Œ</strong>ë©ë‹ˆë‹¤.</li>
                </ul>
            </div>

            <div style="background: #f9f9f9; padding: 20px; border-radius: 8px; margin-bottom: 25px; border: 1px solid #eee;">
                <p style="font-weight: bold; margin-bottom: 12px; font-size: 15px;">ğŸ’° ê²°ì œ ê¸ˆì•¡ ì„ íƒ</p>
                <div style="display: flex; gap: 15px; align-items: center; flex-wrap: wrap;">
                    <label style="font-size: 14px; cursor:pointer;"><input type="radio" name="payType" checked onclick="document.getElementById('customPayInput').style.display='none'"> ì „ì•¡ ê²°ì œ</label>
                    <label style="font-size: 14px; cursor:pointer;"><input type="radio" name="payType" onclick="document.getElementById('customPayInput').style.display='flex'"> ê¸ˆì•¡ ì§ì ‘ ì…ë ¥</label>
                    <div id="customPayInput" style="display: none; align-items: center; gap: 5px; flex: 1;">
                        <input type="text" class="input-field" placeholder="ê¸ˆì•¡ ì…ë ¥" style="flex:1; height:40px;">
                        <span style="font-size:14px; color:#666;">ì›</span>
                    </div>
                </div>
                <p style="font-size: 12.5px; color: #bd2aa4; margin-top: 10px; font-weight: 500;">* ì´ ê²°ì œ ì˜ˆì • ê¸ˆì•¡: â‚© ${document.getElementById('totalAmount').innerText}</p>
            </div>
            
            <div class="button-group" style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 20px;">
                <button class="filter-btn active" onclick="selectPayMode('domestic-manual', this)">êµ­ë‚´ì¹´ë“œ(ìˆ˜ê¸°)</button>
                <button class="filter-btn" onclick="selectPayMode('domestic-manual-none', this)">êµ­ë‚´ì¹´ë“œ</button>
                <button class="filter-btn" onclick="selectPayMode('global-manual', this)">í•´ì™¸ì¹´ë“œ(ìˆ˜ê¸°)</button>
                <button class="filter-btn" onclick="selectPayMode('global-manual-none', this)">í•´ì™¸ì¹´ë“œ</button>
            </div>
            
            <div id="manual-card-area" style="display:grid; grid-template-columns: 1fr 1fr; gap:15px; margin-bottom: 25px;">
    
                <div style="grid-column: span 2;">
                    <label style="display:block; font-size: 14px; margin-bottom: 5px; font-weight: bold; color: #333;">ì¹´ë“œë²ˆí˜¸</label>
                    <input type="text" class="input-field" style="width:100%; box-sizing: border-box;" placeholder="ìˆ«ì 16ìë¦¬ë¥¼ ì…ë ¥í•˜ì„¸ìš”">
                </div>

                <div>
                    <label style="display:block; font-size: 14px; margin-bottom: 5px; font-weight: bold; color: #333;">ì¸ì¦ì •ë³´</label>
                    <input type="text" class="input-field" style="width:100%; box-sizing: border-box;" placeholder="ìƒë…„ì›”ì¼(6ìë¦¬) ë˜ëŠ” ì‚¬ì—…ìë²ˆí˜¸">
                </div>

                <div>
                    <label style="display:block; font-size: 14px; margin-bottom: 5px; font-weight: bold; color: #333;">ìœ íš¨ê¸°ê°„ (ì›”/ë…„)</label>
                    <div style="display:flex; gap:5px;">
                        <input type="text" class="input-field" placeholder="MM" style="width:50%; box-sizing: border-box;">
                        <input type="text" class="input-field" placeholder="YY" style="width:50%; box-sizing: border-box;">
                    </div>
                </div>

                <div>
                    <label style="display:block; font-size: 14px; margin-bottom: 5px; font-weight: bold; color: #333;">ë¹„ë°€ë²ˆí˜¸</label>
                    <input type="password" class="input-field" style="width:100%; box-sizing: border-box;" placeholder="ì• 2ìë¦¬ ì…ë ¥">
                </div>

                <div>
                    <label style="display:block; font-size: 14px; margin-bottom: 5px; font-weight: bold; color: #333;">í• ë¶€ ì„¤ì •</label>
                    <select class="input-field" style="width:100%; box-sizing: border-box; height: 48px;">
                        <option>ì¼ì‹œë¶ˆ</option>
                        <option>2ê°œì›”</option>
                        <option>3ê°œì›”</option>
                    </select>
                </div>

            </div>
            
            <div id="manual-card-area-global" style="display:grid; grid-template-columns: 1fr 1fr; gap:15px; margin-bottom: 25px;">
    
                <div style="grid-column: span 2;">
                    <label style="display:block; font-size: 14px; margin-bottom: 5px; font-weight: bold; color: #333;">ì¹´ë“œë²ˆí˜¸(ìˆ«ìë§Œ)</label>
                    <input type="text" class="input-field" style="width:100%; box-sizing: border-box;" placeholder="Card Number">
                </div>

                <div>
                    <label style="display:block; font-size: 14px; margin-bottom: 5px; font-weight: bold; color: #333;">ìœ íš¨ê¸°ê°„ (ì›”/ë…„)</label>
                    <div style="display:flex; gap:5px;">
                        <input type="text" class="input-field" placeholder="MM" style="width:50%; box-sizing: border-box;">
                        <input type="text" class="input-field" placeholder="YY" style="width:50%; box-sizing: border-box;">
                    </div>
                </div>

            </div>

            <div style="text-align: center; border-top: 1px solid #eee; padding-top: 25px;">
                <div style="margin-bottom: 20px;">
                    <span style="color: #888; font-size: 14px;">ìµœì¢… ê²°ì œ ê¸ˆì•¡</span>
                    <h2 style="color: #bd2aa4; font-size: 32px; margin-top: 5px;">â‚© ${document.getElementById('totalAmount').innerText}</h2>
                </div>
                <button class="btn-reserve" style="background:#bd2aa4; color:white; width:100%; height:60px; font-size:20px; border-radius:8px; border:none; font-weight:bold; cursor:pointer;" onclick="requestHotelBooking()">
                    ì˜ˆì•½í•˜ê¸°
                </button>
            </div>
        </div>

        </div>
    </div>`;

    html += getFooter();
    document.getElementById("content-area").innerHTML = html;
    window.scrollTo(0,0);
}

// 1. ëª¨ë‘ ë™ì˜ ê¸°ëŠ¥
window.allAgree = function(target) {
    const checkboxes = document.querySelectorAll('.agree-chk');
    checkboxes.forEach((checkbox) => {
        checkbox.checked = target.checked;
    });
};

// 2. ê°œë³„ ì²´í¬ë°•ìŠ¤ í´ë¦­ ì‹œ 'ëª¨ë‘ ë™ì˜' ì²´í¬ë°•ìŠ¤ ìƒíƒœ ì—…ë°ì´íŠ¸
document.addEventListener('change', function(e) {
    if (e.target.classList.contains('agree-chk')) {
        const allBtn = document.getElementById('all-check');
        const total = document.querySelectorAll('.agree-chk').length;
        const checked = document.querySelectorAll('.agree-chk:checked').length;
        allBtn.checked = (total === checked);
    }
});

// 3. ì „ë¬¸ë³´ê¸° íŒì—… ì—´ê¸°
window.showTerms = function(content) {
    document.getElementById('termsContent').innerText = content;
    document.getElementById('termsModal').style.display = 'flex';
};

// 4. ì „ë¬¸ë³´ê¸° íŒì—… ë‹«ê¸°
window.closeTerms = function() {
    document.getElementById('termsModal').style.display = 'none';
};

// ì „ë¬¸ë³´ê¸° í•¨ìˆ˜
window.showTerms = function(type) {
    // data.jsì— ì €ì¥ëœ TERMS_DATAë¥¼ ì°¸ì¡°í•©ë‹ˆë‹¤.
    const content = window.TERMS_DATA[type]; 
    
    const titles = {
        privacy: "ê°œì¸ì •ë³´ ìˆ˜ì§‘ ë° ì´ìš© ë™ì˜",
        identification: "ê³ ìœ ì‹ë³„ì •ë³´ ìˆ˜ì§‘ ì´ìš© ë™ì˜",
        consignment: "ê°œì¸ì •ë³´ ìœ„íƒ ë™ì˜",
        thirdparty: "ê°œì¸ì •ë³´ ì œ3ì ì œê³µ ë™ì˜"
    };

    if (content) {
        document.getElementById('termsTitle').innerText = titles[type];
        document.getElementById('termsContent').innerText = content;
        document.getElementById('termsModal').style.display = 'flex';
    } else {
        alert("ë‚´ìš©ì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
    }
};

window.validateLogin = function() {
    const emailInput = document.getElementById('loginEmail');
    const pwInput = document.getElementById('loginPw');
    const pwConfirmInput = document.getElementById('loginPwConfirm');
    const btn = document.querySelector('.filter-btn'); // ë²„íŠ¼ ì„ íƒ
    const msgArea = document.getElementById('loginMsg');

    const email = emailInput.value;
    const pw = pwInput.value;
    const pwConfirm = pwConfirmInput.value;

    // 1. ì´ë©”ì¼ í˜•ì‹ ì²´í¬
    const emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    if (!emailPattern.test(email)) {
        msgArea.innerText = "âŒ ì˜¬ë°”ë¥¸ ì´ë©”ì¼ í˜•ì‹ì´ ì•„ë‹™ë‹ˆë‹¤. ë‹¤ì‹œ í™•ì¸í•´ ì£¼ì„¸ìš”.";
        msgArea.style.color = "#e74c3c";
        return;
    }

    // 2. ë¹„ë°€ë²ˆí˜¸ ì¼ì¹˜ ì²´í¬
    if (pw === "" || pwConfirm === "") {
        msgArea.innerText = "âŒ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ ì£¼ì„¸ìš”.";
        msgArea.style.color = "#e74c3c";
        return;
    }

    if (pw !== pwConfirm) {
        msgArea.innerText = "âŒ ë¹„ë°€ë²ˆí˜¸ì™€ ë¹„ë°€ë²ˆí˜¸ í™•ì¸ì´ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.";
        msgArea.style.color = "#e74c3c";
        return;
    }

    // âœ… 3. ëª¨ë“  ì¡°ê±´ í†µê³¼ ì‹œ (ìˆ˜ì •ëœ ë¶€ë¶„)
    msgArea.innerText = "âœ… ë¡œê·¸ì¸ ì •ë³´ê°€ í™•ì¸ë˜ì—ˆìŠµë‹ˆë‹¤.";
    msgArea.style.color = "#27ae60";

    // ì…ë ¥ì°½ ê³ ì • (ìˆ˜ì • ë¶ˆê°€)
    emailInput.readOnly = true;
    pwInput.readOnly = true;
    pwConfirmInput.readOnly = true;
    
    // ë°°ê²½ìƒ‰ì„ ì‚´ì§ íšŒìƒ‰ìœ¼ë¡œ ë°”ê¿” ê³ ì •ëœ ëŠë‚Œ ì£¼ê¸° (ì„ íƒì‚¬í•­)
    emailInput.style.backgroundColor = "#f0f0f0";
    pwInput.style.backgroundColor = "#f0f0f0";
    pwConfirmInput.style.backgroundColor = "#f0f0f0";

    // ë²„íŠ¼ ìƒíƒœ ë³€ê²½ ë° ë¹„í™œì„±í™”
    btn.innerText = "í™•ì¸ ì™„ë£Œ";
    btn.disabled = true;
    btn.style.backgroundColor = "#ccc"; // ë¹„í™œì„±í™” ëŠë‚Œì˜ ìƒ‰ìƒ
    btn.style.cursor = "default";
}

function selectPayMode(mode, targetBtn) {
    // 1. ëª¨ë“  ë²„íŠ¼ì—ì„œ 'active' í´ë˜ìŠ¤ë¥¼ ì‹¹ ë‹¤ ì œê±° (ë™ì‹œ ì„ íƒ ë°©ì§€)
    const allButtons = document.querySelectorAll('.filter-btn');
    allButtons.forEach(btn => btn.classList.remove('active'));

    // 2. ë‚´ê°€ í´ë¦­í•œ ë²„íŠ¼ë§Œ 'active' ì¶”ê°€
    targetBtn.classList.add('active');

    // 3. ì…ë ¥ ì˜ì—­ ì´ˆê¸°í™” (ì¼ë‹¨ ë‹¤ ìˆ¨ê¸°ê¸°)
    const domesticArea = document.getElementById('manual-card-area');
    const globalArea = document.getElementById('manual-card-area-global');
    
    if (domesticArea) domesticArea.style.display = 'none';
    if (globalArea) globalArea.style.display = 'none';

    // 4. ì„ íƒí•œ ëª¨ë“œì— ë§ì¶° í•´ë‹¹ ì˜ì—­ë§Œ ë³´ì—¬ì£¼ê¸°
    if (mode === 'domestic-manual') {
        domesticArea.style.display = 'grid';
    } else if (mode === 'global-manual') {
        globalArea.style.display = 'grid';
    } else if (mode === 'domestic-manual-none') {
        domesticArea.style.display = 'none';
    } else if (mode === 'global-manual-none') {
        globalArea.style.display = 'none';
    }
    // ì¼ë°˜ê²°ì œ(domestic-general, global-general)ëŠ” ì˜ì—­ì„ ëª¨ë‘ ìˆ¨ê¸´ ìƒíƒœë¡œ ìœ ì§€
}

// ì²´í¬ì¸ ë‚ ì§œë¡œë¶€í„° 3ì¼ ì „ì„ ê³„ì‚°í•´ì£¼ëŠ” í•¨ìˆ˜
function getCancelDate(checkInDateStr) {
    if (!checkInDateStr) return "ì²´í¬ì¸ 3ì¼ ì „";
    
    const checkIn = new Date(checkInDateStr);
    // ì²´í¬ì¸ ë‚ ì§œì—ì„œ 7ì¼ì„ ëºŒ
    checkIn.setDate(checkIn.getDate() - 7);
    
    const year = checkIn.getFullYear();
    const month = checkIn.getMonth() + 1;
    const day = checkIn.getDate();
    
    return `${year}ë…„ ${month}ì›” ${day}ì¼`;
}

function copyGuestInfo(checkbox) {
    const master = document.getElementById('master-info');
    const guestList = document.getElementById('guest-list');
    const firstGuest = guestList.querySelector('.guest-item');

    if (!master || !firstGuest) return;

    const masterName = master.querySelector('.master-name');
    const masterBirth = master.querySelector('.master-birth');
    const masterPhone = master.querySelector('.master-phone');
    const masterEmail = master.querySelector('.master-email');
    const masterNation = master.querySelector('.master-nation');

    const guestName = firstGuest.querySelector('.g-name');
    const guestBirth = firstGuest.querySelector('.g-birth');
    const guestPhone = firstGuest.querySelector('.g-phone');
    const guestEmail = firstGuest.querySelector('.g-email');
    const guestNation = firstGuest.querySelector('.g-nation');

    if (checkbox.checked) {
        if (guestName && masterName) guestName.value = masterName.value;
        if (guestBirth && masterBirth) guestBirth.value = masterBirth.value;
        if (guestPhone && masterPhone) guestPhone.value = masterPhone.value;
        if (guestEmail && masterEmail) guestEmail.value = masterEmail.value;
        if (guestNation && masterNation) guestNation.value = masterNation.value;
    } else {
        if (guestName) guestName.value = "";
        if (guestBirth) guestBirth.value = "";
        if (guestPhone) guestPhone.value = "";
        if (guestEmail) guestEmail.value = "";
    }
}

//ì—¬í–‰ì ì¶”ê°€ ë²„íŠ¼
function addGuest() {
    const guestList = document.getElementById('guest-list');
    const currentCount = guestList.getElementsByClassName('guest-item').length + 1;

    const newGuest = document.createElement('div');
    newGuest.className = 'guest-item';
    newGuest.style.cssText = "border:1px solid #eee; padding:20px; border-radius:12px; margin-bottom:15px; background:#fff; position:relative;";

    newGuest.innerHTML = `
        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:15px;">
            <strong style="color:#bd2aa4;">ì¶”ê°€ ê°ì‹¤ ì˜ˆì•½ì ${currentCount}</strong>
            <button onclick="this.parentElement.parentElement.remove()" style="color:#ff4d4d; background:none; border:none; cursor:pointer; font-size:12px;">âœ• ì‚­ì œ</button>
        </div>
        <div style="display:grid; grid-template-columns:1fr 1fr; gap:12px;">
            <input type="text" class="input-field g-name" placeholder="ì„±ëª…">
            <input type="text" class="input-field g-birth" placeholder="ë²•ì •ìƒë…„ì›”ì¼">
            <input type="tel" class="input-field g-phone" placeholder="ì—°ë½ì²˜">
            <input type="email" class="input-field g-email" placeholder="ì´ë©”ì¼">
            <select class="input-field g-nation" style="grid-column: span 2;">
                ${countryOptions}
            </select>
        </div>
    `;

    guestList.appendChild(newGuest);
}

window.requestHotelBooking = function() {
    // 1. ë¡œê·¸ì¸ ì •ë³´ í™•ì¸ ì™„ë£Œ ì—¬ë¶€ ì²´í¬
    const loginBtn = document.querySelector('.validateLoginBtn') || document.querySelector('.filter-btn');
    
    // ë²„íŠ¼ì´ ì—†ê±°ë‚˜, ë¹„í™œì„±í™”(disabled)ë˜ì§€ ì•Šì•˜ìœ¼ë©´ì„œ í…ìŠ¤íŠ¸ë„ 'í™•ì¸ ì™„ë£Œ'ê°€ ì•„ë‹ˆë©´ í†µê³¼ ëª»í•¨
    if (loginBtn && !loginBtn.disabled && loginBtn.innerText !== "í™•ì¸ ì™„ë£Œ") {
        alert("âš ï¸ [ë¡œê·¸ì¸ ì •ë³´] í™•ì¸í•˜ê¸° ë²„íŠ¼ì„ ë¨¼ì € ëˆŒëŸ¬ì£¼ì„¸ìš”.");
        loginBtn.scrollIntoView({ behavior: 'smooth', block: 'center' });
        return;
    }

    // 2. ì•½ê´€ í•„ìˆ˜ ë™ì˜ ì—¬ë¶€ ì²´í¬
    const agrees = document.querySelectorAll('.agree-chk');
    const isAllAgreed = Array.from(agrees).every(chk => chk.checked);

    if (!isAllAgreed) {
        alert("âš ï¸ ëª¨ë“  í•„ìˆ˜ ì•½ê´€ì— ë™ì˜í•˜ì…”ì•¼ ì˜ˆì•½ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.");
        const allCheck = document.getElementById('all-check');
        if(allCheck) allCheck.focus();
        return;
    }

    // 3. ëŒ€í‘œ ì˜ˆì•½ì ì •ë³´ ë¹ˆì¹¸ ì²´í¬
    // input-field í´ë˜ìŠ¤ë¥¼ ê°€ì§„ ìš”ì†Œ ì¤‘ ë¹„ì–´ìˆëŠ” ê²Œ ìˆëŠ”ì§€ ê²€ì‚¬
    const masterInputs = document.querySelectorAll('.section-card .input-field'); 
    for (let input of masterInputs) {
        // select ë°•ìŠ¤ê°€ ì•„ë‹ˆê³  ê°’ì´ ë¹„ì–´ìˆë‹¤ë©´ ê²½ê³ 
        if (input.tagName !== 'SELECT' && input.value.trim() === "") {
            alert(`âš ï¸ ëª¨ë“  ì˜ˆì•½ì ì •ë³´ë¥¼ ì •í™•íˆ ì…ë ¥í•´ì£¼ì„¸ìš”.`);
            input.focus();
            return;
        }
    }

    submitFinal();
};

async function submitFinal() {
    const loginEmailInput = document.getElementById('loginEmail');
    const loginPwInput = document.getElementById('loginPw');

    const master = document.getElementById('master-info');
    const masterName = master.querySelector('.master-name');
    const masterPhone = master.querySelector('.master-phone');
    const masterEmail = master.querySelector('.master-email');

    const totalText = document.getElementById('totalAmount').innerText || "0";
    const numericTotal = parseInt(totalText.replace(/[^0-9]/g, ''), 10) || 0;

    const hotel = HOTEL_DATA.find(h => h.id === state.currentHotelId);

    const payload = {
        hotelName: hotel ? hotel.name : '',
        guestName: masterName ? masterName.value : '',
        guestEmail: (loginEmailInput && loginEmailInput.value) || (masterEmail ? masterEmail.value : ''),
        password: loginPwInput ? loginPwInput.value : '',
        checkIn: state.checkIn || '',
        totalPrice: numericTotal
    };

    try {
        const response = await fetch('/api/reserve', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(payload)
        });

        const result = await response.json();

        if (!response.ok) {
            alert(result.error || "ì˜ˆì•½ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
            return;
        }

        alert(`âœ… ì˜ˆì•½ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ì˜ˆì•½ë²ˆí˜¸: ${result.id}`);
        window.location.reload();
    } catch (error) {
        console.error("ì˜ˆì•½ ìš”ì²­ ì—ëŸ¬:", error);
        alert("ì„œë²„ì™€ í†µì‹  ì¤‘ ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
    }
}
// í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸° ì‹¤í–‰
window.onload = () => {
    updateHeader();
    showSection('booking');
};
</script>
</body>

</html>




